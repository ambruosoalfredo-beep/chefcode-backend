<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChefCode - Workflow Simulation</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@30    /* Stili per i pulsanti del footer ChatGPT */
    #voice-footer #send-btn,
    #voice-footer #upload-btn,
    #voice-footer #voice-chat-btn {
        background: linear-gradient(145deg, #ffffff, #e8e8e8) !important;
        border: 2px solid #ffffff !important;
        color: #2c3e50 !important;
        border-radius: 50% !important;
        width: 45px !important;
        height: 45px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
        transition: all 0.3s ease !important;
        cursor: pointer !important;
    }
    
    #voice-footer #send-btn:hover,
    #voice-footer #upload-btn:hover,
    #voice-footer #voice-chat-btn:hover {
        background: linear-gradient(145deg, #f8f9fa, #ffffff) !important;
        border-color: #a9cce3 !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2) !important;
        color: #1e3a8a !important;
    }
    
    #voice-footer #send-btn:active,
    #voice-footer #upload-btn:active,
    #voice-footer #voice-chat-btn:active {
        transform: translateY(0px) !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Stato attivo per il pulsante voice-chat quando sta registrando */
    #voice-footer #voice-chat-btn.recording {
        background: linear-gradient(145deg, #ff6b6b, #ff5252) !important;
        border-color: #ff4444 !important;
        color: #ffffff !important;
        animation: pulse 1.5s infinite !important;
    }splay=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2E4E6F">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ChefCode">
    <link rel="apple-touch-icon" href="pwa-icon-apple.png">
    <link rel="icon" type="image/png" sizes="192x192" href="pwa-icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="pwa-icon-512.png">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="home-button" id="chefcode-logo-btn">
                <i class="fas fa-home"></i>
            </button>
        </div>
        <div class="header-center">
            <h1 class="logo">ChefCode</h1>
        </div>
        <div class="header-right">
            <!-- Spazio vuoto per mantenere il layout centrato -->
        </div>
    </header>

    <!-- Pulsante Account fisso fuori dall'header -->
    <div class="account-menu-fixed">
        <button class="account-button">
            <i class="fas fa-user-circle"></i>
        </button>
        <div class="dropdown-content">
            <a href="#">Profile</a>
            <a href="#">Settings</a>
            <a href="#">Logout</a>
        </div>
    </div>

    <main class="main-container">
        <!-- ...existing code... -->
        <section id="step-selection-page" class="page-section active">
            <div class="step-buttons-grid">
                <button class="big-step-button" data-step="goods-in">
                    <i class="fas fa-box-open"></i>
                    <span>GOODS IN</span>
                </button>
                <button class="big-step-button" data-step="recipe-set-up">
                    <i class="fas fa-utensils"></i>
                    <span>RECIPE SET-UP</span>
                </button>
                <button class="big-step-button" data-step="production">
                    <i class="fas fa-industry"></i>
                    <span>PRODUCTION</span>
                </button>
                <button class="big-step-button" data-step="sales">
                    <i class="fas fa-cash-register"></i>
                    <span>SALES</span>
                </button>
                <button class="big-step-button" data-step="end-of-day">
                    <i class="fas fa-shopping-basket"></i>
                    <span>SHOPPING LIST</span>
                </button>
                <button class="big-step-button" data-step="dashboard-selection">
                    <i class="fas fa-chart-line"></i>
                    <span>DASHBOARD</span>
                </button>
                <button class="big-step-button" data-step="inventory-page">
                    <i class="fas fa-clipboard-check"></i>
                    <span>INVENTORY</span>
                </button>
                <button class="big-step-button" data-step="add-module">
                    <i class="fas fa-plus"></i>
                    <span>ADD MODULE</span>
                </button>
            </div>
        </section>

        <section id="input-detail-page" class="page-section">
            <div id="input-pages-container">
                
                <div id="goods-in-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>GOODS IN</h3></div>
                    <div class="goods-in-buttons-grid">
                        <button class="big-step-button" data-action="invoice-photo"><i class="fas fa-camera"></i><span>INVOICE PHOTO (OCR)</span></button>
                        <button class="big-step-button" data-action="voice-input" style="display:none;"><i class="fas fa-microphone"></i><span>VOICE INPUT</span></button>
                        <button class="big-step-button" data-action="manual-input"><i class="fas fa-keyboard"></i><span>MANUAL INPUT</span></button>
                    </div>
                </div>

                <div id="manual-input-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="goods-in-content"><i class="fas fa-arrow-left"></i> Back</button><h3>MANUAL INPUT</h3></div>
                    <form id="manual-entry-form" class="manual-form">
                        <div class="form-group full-width"><label for="item-name">Item Name</label><input type="text" id="item-name" name="item-name" placeholder="e.g., San Marzano Tomatoes" required></div>
                        <div class="form-group"><label for="item-quantity">Quantity</label><input type="number" id="item-quantity" name="item-quantity" placeholder="e.g., 25" step="0.01" required></div>
                        <div class="form-group"><label for="item-unit">Unit</label><input type="text" id="item-unit" name="item-unit" placeholder="e.g., kg" required></div>
                        <div class="form-group"><label for="item-category">Category</label><input type="text" id="item-category" name="item-category" placeholder="e.g., Vegetables" required></div>
                        <div class="form-group"><label for="item-price">Unit Price (‚Ç¨)</label><input type="number" id="item-price" name="item-price" placeholder="e.g., 2.50" step="0.01" required></div>
                    <div style="text-align:center; margin-top:16px;">
                        <button type="submit" class="submit-btn"><i class="fas fa-save"></i> Add to Inventory</button>
                    </div>
                    </form>
                </div>

                <div id="dashboard-selection-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>Select Dashboard</h3></div>
                    <div class="step-buttons-grid">
                        <button class="big-step-button" data-step="kitchen-dashboard"><i class="fas fa-utensils"></i><span>KITCHEN DASHBOARD</span></button>
                        <button class="big-step-button" data-step="management-dashboard"><i class="fas fa-chart-bar"></i><span>MANAGEMENT DASHBOARD</span></button>
                    </div>
                </div>
                
                <div id="kitchen-dashboard-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="dashboard-selection-content"><i class="fas fa-arrow-left"></i> Back</button><h3>Chef's Operational Dashboard</h3></div>
                    <div class="new-dashboard-grid kitchen-dash"><div class="new-dash-card"><h5 class="new-card-title">Today's Work Plan (Mise en Place)</h5><table class="prep-list-table"><thead><tr><th>Priority</th><th>Task</th><th>Status</th></tr></thead><tbody><tr><td><span class="priority high">High</span></td><td>Prepare Amatriciana Sauce (5L)</td><td><span class="status done">Done</span></td></tr><tr><td><span class="priority high">High</span></td><td>Clean Mussels and Clams</td><td><span class="status done">Done</span></td></tr><tr><td><span class="priority medium">Medium</span></td><td>Cut Vegetables for Soffritto</td><td><span class="status pending">To Do</span></td></tr><tr><td><span class="priority medium">Medium</span></td><td>Fillet Sea Bass (10 pcs)</td><td><span class="status pending">To Do</span></td></tr></tbody></table></div><div class="new-dash-card"><h5 class="new-card-title">Today's "Hot" Items</h5><table class="hot-items-table"><thead><tr><th>Dish</th><th>Qty</th><th>Margin</th></tr></thead><tbody><tr><td>Spaghetti Carbonara</td><td>18</td><td><span class="margin good">‚Ç¨ 10.90</span></td></tr><tr><td>Frittura di Calamari</td><td>12</td><td><span class="margin ok">‚Ç¨ 9.90</span></td></tr><tr><td>Tagliata di Manzo</td><td>9</td><td><span class="margin good">‚Ç¨ 14.30</span></td></tr><tr><td>Tonnarelli Cacio e Pepe</td><td>7</td><td><span class="margin good">‚Ç¨ 9.80</span></td></tr></tbody></table></div><div class="new-dash-card"><h5 class="new-card-title">Critical Stock</h5><ul class="dash-list"><li>Guanciale (under 1 kg)</li><li>Pecorino Romano</li><li>White Wine for cooking</li></ul></div><div class="new-dash-card"><h5 class="new-card-title">Use Soon (Anti-Waste)</h5><ul class="dash-list"><li>Fresh Porcini Mushrooms</li><li>Buffalo Mozzarella</li><li>Fresh Basil</li></ul></div><div class="new-dash-card full-width"><h5 class="new-card-title">Menu Engineering Analysis</h5><div class="menu-engineering-grid"><div class="quadrant puzzle"><h6>PUZZLES ‚ùì</h6><small>High profit, low popularity. Needs promotion.</small><p>Filetto al Pepe Verde</p></div><div class="quadrant star"><h6>STARS ‚≠ê</h6><small>High profit, high popularity. Our champions!</small><p>Tagliata di Manzo</p><p>Spaghetti Carbonara</p></div><div class="quadrant dog"><h6>DOGS üê∂</h6><small>Low profit, low popularity. Consider removing.</small><p>Insalatona "Chef"</p></div><div class="quadrant plow-horse"><h6>PLOW-HORSES üê¥</h6><small>Low profit, high popularity. Optimize cost.</small><p>Frittura di Calamari</p></div></div></div></div>
                </div>

                <div id="management-dashboard-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="dashboard-selection-content"><i class="fas fa-arrow-left"></i> Back</button><h3>Management Dashboard</h3></div>
                    <div class="new-dashboard-grid"><div class="new-dash-card kpi-card"><h5 class="kpi-title">REVENUE</h5><p class="kpi-amount">$895,430</p></div><div class="new-dash-card kpi-card"><h5 class="kpi-title">AVERAGE TRANSACTION</h5><p class="kpi-amount">$34.49</p><small class="kpi-change up"><i class="fas fa-caret-up"></i> 3,1%</small></div><div class="new-dash-card kpi-card"><h5 class="kpi-title">ORDERS</h5><p class="kpi-amount">25,959</p><small class="kpi-change down"><i class="fas fa-caret-down"></i> 2,5%</small></div><div class="new-dash-card tall"><h5 class="new-card-title">SALES BY MONTH</h5><div class="bar-chart-v"><div class="bar-wrapper"><div class="bar" style="height: 20%;"></div><span class="bar-label-month">Jan</span></div><div class="bar-wrapper"><div class="bar" style="height: 30%;"></div><span class="bar-label-month">Feb</span></div><div class="bar-wrapper"><div class="bar" style="height: 45%;"></div><span class="bar-label-month">Mar</span></div><div class="bar-wrapper"><div class="bar" style="height: 60%;"></div><span class="bar-label-month">Apr</span></div><div class="bar-wrapper"><div class="bar" style="height: 55%;"></div><span class="bar-label-month">May</span></div><div class="bar-wrapper"><div class="bar" style="height: 70%;"></div><span class="bar-label-month">Jun</span></div><div class="bar-wrapper"><div class="bar" style="height: 85%;"></div><span class="bar-label-month">Jul</span></div><div class="bar-wrapper"><div class="bar" style="height: 95%;"></div><span class="bar-label-month">Aug</span></div></div></div><div class="new-dash-card tall"><h5 class="new-card-title">SALES BY CHANNEL</h5><div class="chart-with-legend"><div class="pie-chart"></div><div class="channel-list"><div class="channel-item"><i class="fas fa-circle channel-icon dine-in"></i><span class="channel-label">Dine-in</span><span class="channel-perc">70%</span></div><div class="channel-item"><i class="fas fa-circle channel-icon takeaway"></i><span class="channel-label">Takeaway</span><span class="channel-perc">15%</span></div><div class="channel-item"><i class="fas fa-circle channel-icon delivery"></i><span class="channel-label">Delivery</span><span class="channel-perc">15%</span></div></div></div></div><div class="new-dash-card tall"><h5 class="new-card-title">SALES BY CATEGORY</h5><div class="bar-chart-h"><div class="bar-item"><span class="bar-label">Food</span><div class="bar-bg"><div class="bar-fg food" style="width: 62%;"></div></div><span class="bar-perc">62%</span></div><div class="bar-item"><span class="bar-label">Beverage</span><div class="bar-bg"><div class="bar-fg beverage" style="width: 21%;"></div></div><span class="bar-perc">21%</span></div><div class="bar-item"><span class="bar-label">Dessert</span><div class="bar-bg"><div class="bar-fg dessert" style="width: 11%;"></div></div><span class="bar-perc">11%</span></div><div class="bar-item"><span class="bar-label">Other</span><div class="bar-bg"><div class="bar-fg other" style="width: 6%;"></div></div><span class="bar-perc">6%</span></div></div></div></div>
                </div>

                <div id="inventory-page-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>FOOD INVENTORY</h3></div>
                    <div class="inventory-controls">
                        <input type="search" id="inventory-search" placeholder="Search by name..."><select id="inventory-category-filter"><option value="all">All Categories</option><option value="Vegetables">Vegetables</option><option value="Dry Goods">Dry Goods</option><option value="Dairy">Dairy</option><option value="Meat">Meat</option><option value="Oils">Oils</option><option value="Herbs">Herbs</option><option value="Pasta">Pasta</option><option value="Fish">Fish</option><option value="Legumes">Legumes</option><option value="Bakery">Bakery</option><option value="Beverages">Beverages</option><option value="Sweets">Sweets</option><option value="Condiments">Condiments</option><option value="Nuts">Nuts</option></select>
                        <button id="expand-table-btn" class="icon-btn" title="Collapse to Summary"><i class="fas fa-chevron-up"></i></button>
                    </div>
                    <div class="inventory-table-container">
                        <table>
                            <thead><tr><th>Item</th><th>Unit Price</th><th>Unit</th><th>Quantity</th><th>Category</th><th>Total Value</th></tr></thead>
                            <tbody id="inventory-table-body">
                                <!-- Inventory items will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    <div class="inventory-summary"><h4>Total Inventory Value: <span id="inventory-total-value">‚Ç¨2,362.90</span></h4></div>
                </div>

                <div id="camera-simulation-page" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="goods-in-content"><i class="fas fa-arrow-left"></i> Back</button><h3>TAKE INVOICE PHOTO</h3></div>
                    <div class="camera-preview-container"><div class="camera-viewfinder"><i class="fas fa-camera-retro"></i><p>Place invoice here</p></div></div>
                    <div class="camera-controls">
                        <button id="take-photo-btn" class="input-btn"><i class="fas fa-circle"></i><span>Take Photo</span></button>
                        <button id="retake-photo-btn" class="input-btn" style="display: none;"><i class="fas fa-redo"></i><span>Retake Photo</span></button>
                        <button id="confirm-photo-btn" class="input-btn" style="display: none;"><i class="fas fa-check"></i><span>Confirm Photo & OCR</span></button>
                    </div>
                    <div class="output-section camera-output" style="display: none;">
                        <h4>OCR Result Simulation</h4>
                        <ul><li>Invoice #: INV2025-07-001</li><li>Date: 03/07/2025</li><li>Supplier: Global Foods S.p.A.</li><li>Items detected: 5</li><li>Total Amount: ‚Ç¨150.00</li></ul>
                    </div>
                </div>

                <div id="voice-input-page-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="goods-in-content"><i class="fas fa-arrow-left"></i> Back</button><h3>VOICE INPUT</h3></div>
                    <div class="voice-input-container">
                        <p id="voice-status">Voice input temporarily disabled</p>
                        <div class="voice-mic-container" style="display: none;"><button id="microphone-btn"><i class="fas fa-microphone"></i></button><span id="mic-label">Start Recording</span></div>
                        <div id="voice-recognized-text" class="output-section" style="display: none;">
                            <h4>Recognized Text</h4><p id="recognized-text-content"></p>
                            <button id="process-voice-btn" class="input-btn"><i class="fas fa-check"></i><span>Process Input</span></button>
                        </div>
                    </div>
                </div>

                <div id="recipe-set-up-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>RECIPE SET-UP</h3></div>
                    <form id="recipe-form">
                        <div class="form-group full-width"><label for="recipe-name">Recipe Name</label><input type="text" id="recipe-name" required placeholder="e.g., Spaghetti alla Carbonara"></div>
                        <div class="form-group full-width"><label for="recipe-instructions">Instructions</label><textarea id="recipe-instructions" rows="4" placeholder="Describe the preparation steps..."></textarea></div>
                    </form>
                    <!-- === RECIPE YIELD (quanto prodotto fa 1 batch) === -->
<div class="form-group full-width">
    <label for="recipe-yield-qty">Recipe yield (product obtained per batch)</label>
  <div class="yield-row">
        <div style="display:flex; gap:10px; align-items:center;">
            <input type="number" id="recipe-yield-qty" placeholder="es. 10" step="0.01" style="width:100px;">
            <select id="recipe-yield-unit" style="width:80px;">
                <option value="pz">pz</option>
                <option value="kg">kg</option>
                <option value="g">g</option>
                <option value="lt">lt</option>
                <option value="ml">ml</option>
            </select>
        </div>
  </div>
</div>

                    <div class="add-ingredient-section">
                        <div class="form-group"><label for="ingredient-select">Select Ingredient</label><select id="ingredient-select"><option value="" disabled selected>-- Choose an ingredient --</option></select></div>
                        <div class="form-group"><label for="ingredient-qty">Quantity</label><input type="number" id="ingredient-qty" placeholder="e.g., 150"></div>
                        <div class="form-group"><label for="ingredient-unit">Unit</label><select id="ingredient-unit"><option>g</option><option>kg</option><option>ml</option><option>l</option><option>pz</option></select></div>
                        <button id="add-ingredient-btn" class="icon-btn"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="ingredients-list-container">
                        <ul id="recipe-ingredients-list"></ul>
                    </div>
                    <button id="save-recipe-btn" class="submit-btn"><i class="fas fa-save"></i> Save Recipe</button>
                </div>
                
                <div id="production-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>PRODUCTION</h3></div>
<div class="add-production-task-section">
  <!-- Recipe -->
  <div class="form-group">
    <label for="recipe-select-prod">Recipe to Prepare</label>
    <select id="recipe-select-prod">
      <option value="" disabled selected>-- Choose a recipe --</option>
    </select>
  </div>

  <!-- Quantity -->
  <div class="form-group">
    <label for="production-qty">Quantity to Produce</label>
    <input type="text" id="production-qty" placeholder="Insert Quantity">
  </div>

  <!-- Unit√† di misura (resta com‚Äôera) -->
  <div class="form-group">
    <label for="production-unit">Unit</label>
    <select id="production-unit">
      <option value="kg">kg</option>
      <option value="g">g</option>
      <option value="lt">lt</option>
      <option value="ml">ml</option>
      <option value="pz">pz</option>
    </select>
  </div>

  <!-- Assign to -->
  <div class="form-group">
    <label for="assign-to">Assign to</label>
    <select id="assign-to">
      <option>Luca</option>
      <option>Sofia</option>
      <option>Marco</option>
      <option>Tutti</option>
    </select>
  </div>

  <!-- Initial Status (nuovo) -->
 <div class="form-group">
  <label for="initial-status">Initial Status</label>
  <select id="initial-status">
    <option value="todo" selected>To Do</option>
    <option value="completed">Completed Task</option>
  </select>
</div>

<button id="add-task-btn" class="submit-btn small-btn">
  <i class="fas fa-plus"></i> Add to List
    </button>

        <!-- RIMOSSI I TAB BUTTON, SOLO DUE COLONNE VISIBILI -->
    <div class="production-tasks-tabbed">
        <div id="todo-tasks" class="task-list prod-tab-panel active"></div>
        <div id="completed-tasks-list" class="task-list prod-tab-panel"></div>
    </div>

</div>
                                </div>
                </div>

                <div id="sales-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>SALES</h3></div><p>Record sales and update stock.</p>
                </div>
                <div id="end-of-day-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>SHOPPING LIST</h3></div><p>Generate and manage your daily shopping list.</p>
                </div>

                <div id="add-module-content" class="input-page">
                    <div class="page-header-with-back"><button class="back-button" data-back-target="step-selection-page"><i class="fas fa-arrow-left"></i> Back</button><h3>Add New Module</h3></div>
                    <p>Module creation/selection interface will be here...</p>
                </div>

            </div>
        </section>
    </main>
<style>
    /* CORREZIONE GENERALE: Previeni overflow orizzontale */
    * {
        box-sizing: border-box !important;
    }
    
    html, body {
        overflow-x: hidden !important;
        max-width: 100vw !important;
    }
    
    /* Assicura che tutti gli elementi non superino la larghezza viewport */
    /* Rimossa regola troppo aggressiva che interferiva con i pulsanti */
    
    /* Contenitori principali */
    .main-container, .page-section, .input-page {
        width: 100% !important;
        max-width: 100vw !important;
        overflow-x: hidden !important;
    }
    
    /* Tabelle responsive */
    .inventory-table-container {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: auto !important;
    }
    
    table {
        width: 100% !important;
        max-width: 100% !important;
    }
    
    /* Grid responsive - Solo elementi specifici */
    .step-buttons-grid, .new-dashboard-grid, .goods-in-buttons-grid {
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
    }
    
    /* Form responsive - Solo elementi specifici */
    .manual-form, .add-ingredient-section {
        width: 100%;
        max-width: 100%;
        overflow-x: hidden;
    }
    
    /* Media responsive */
    img, video, svg {
        max-width: 100% !important;
        height: auto !important;
        box-sizing: border-box !important;
    }
    
    /* Header responsive */
    .header {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        box-sizing: border-box !important;
        overflow-x: hidden !important;
        z-index: 1000 !important;
        background: #2E4E6F !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
    }
    
    /* Aggiungi padding al contenuto per compensare l'header fisso */
    .main-container {
        padding-top: 170px !important;  /* Aumentato a 170px per assicurare che i pulsantoni siano completamente visibili */
    }
    
    /* Mobile: spazio dinamico basato sull'altezza dell'header */
    @media (max-width: 480px) {
        .main-container {
            padding-top: calc(var(--header-height, 80px) - 30px) !important; /* Header height + 20px margine + 50px extra - 100px verso l'alto */
        }
        
        /* Calcola dinamicamente l'altezza dell'header */
        .header {
            --header-height: auto !important;
        }
    }
    
    /* Stili per il pulsante account fisso */
    .account-menu-fixed .account-button {
        background: transparent !important;
        border: none !important;
        color: #ffffff !important;  /* Colore bianco */
        cursor: pointer !important;
        padding: 8px !important;  /* Ridotto da 10px a 8px */
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        transition: all 0.3s ease !important;
        height: 36px !important;  /* Ridotto da 40px a 36px */
        width: 36px !important;   /* Ridotto da 40px a 36px */
    }
    
    .account-menu-fixed .account-button i {
        font-size: 21px !important;  /* Aumentato del 20% da 18px a 21px */
        color: #ffffff !important;  /* Colore bianco */
    }
    
    .account-menu-fixed .account-button:hover {
        background: rgba(46, 78, 111, 0.1) !important;
        border-radius: 6px !important;
    }
    
    /* Pulsante Account fisso fuori dall'header */
    .account-menu-fixed {
        position: fixed !important;
        top: 35px !important;  /* Alzato di 5px (era 40px, ora 35px) */
        right: 20px !important;  /* Spostato 5px verso sinistra (era 15px, ora 20px) */
        z-index: 2000 !important;  /* Sopra tutto */
    }
    
    .dropdown-content {
        position: absolute !important;
        top: 100% !important;
        right: 0 !important;
        z-index: 2001 !important;  /* Ancora pi√π sopra */
        background: white !important;
        border: 1px solid #e0e0e0 !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        margin-top: 8px !important;
        min-width: 150px !important;
        display: none !important;
    }
    
    .dropdown-content a {
        color: #2c3e50 !important;
        text-decoration: none !important;
        padding: 12px 16px !important;
        display: block !important;
        transition: background 0.3s ease !important;
    }
    
    .dropdown-content a:hover {
        background: #f8f9fa !important;
    }
    
    /* Mostra dropdown al hover */
    .account-menu-fixed:hover .dropdown-content {
        display: block !important;
    }
    
    /* Logo e pulsante home bianchi per header blu */
    .header .logo {
        color: #ffffff !important;
        font-size: 0.9rem !important;  /* Ulteriormente ridotto da 1.1rem a 0.9rem */
    }
    
    .header .home-button {
        background: transparent !important;
        border: none !important;
        color: #ffffff !important;
        cursor: pointer !important;
        padding: 8px !important;  /* Ridotto da 10px a 8px */
        transition: all 0.3s ease !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        height: 36px !important;  /* Ridotto da 40px a 36px */
        width: 36px !important;   /* Ridotto da 40px a 36px */
    }
    
    .header .home-button:hover {
        background: rgba(255, 255, 255, 0.2) !important;
        border-radius: 6px !important;
    }
    
    .header .home-button i {
        font-size: 21px !important;  /* Aumentato del 20% da 18px a 21px */
    }
    
    /* IMPORTANTE: Preserva funzionalit√† JavaScript footer */
    #voice-footer button {
        pointer-events: auto !important;
        cursor: pointer !important;
    }
    
    /* Inizialmente il pulsante send √® nascosto, voice visibile */
    #voice-footer #send-btn {
        display: none; /* Nascosto all'inizio */
    }
    
    #voice-footer #voice-chat-btn {
        display: flex; /* Visibile all'inizio */
    }
    
    #voice-footer #upload-btn {
        display: flex; /* Sempre visibile */
    }
    
    main.main-container { padding-bottom: 120px; }
    footer#voice-footer { 
        width: 100% !important; 
        position: fixed !important; 
        left: 0 !important; 
        bottom: 0 !important; 
        z-index: 100 !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    
    /* Footer blu - SEMPLICE e NATURALE */
    #voice-footer {
        background-color: #2E4E6F !important;
        color: #ffffff !important;
        padding: 10px 15px !important;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1) !important;
        width: 100vw !important;
        max-width: 100vw !important;
        overflow-x: hidden !important;
        box-sizing: border-box !important;
    }
    
    /* Aggiorna i colori del testo nel footer */
    #voice-footer #voice-status-label {
        color: #ffffff !important;
    }
    
    #voice-footer #chatgpt-response {
        color: #ffffff !important;
    }
    
    #voice-footer #voice-result {
        color: #ffffff !important;
    }
    
    /* Stile del pulsante microfono nel footer blu */
    #voice-footer #voice-btn {
        background: rgba(255, 255, 255, 0.1) !important;
        border: 2px solid rgba(255, 255, 255, 0.3) !important;
        border-radius: 50% !important;
        color: #ffffff !important;
        font-size: 2em !important;
        padding: 6px 16px !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }
    
    #voice-footer #voice-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        border-color: rgba(255, 255, 255, 0.5);
    }
    
    /* Stile del pulsante Send nel footer blu */
    #voice-footer button[type="submit"] {
        background: rgba(255, 255, 255, 0.2) !important;
        border: 1px solid rgba(255, 255, 255, 0.3) !important;
        color: #ffffff !important;
        transition: all 0.3s ease;
    }
    
    #voice-footer button[type="submit"]:hover {
        background: rgba(255, 255, 255, 0.3) !important;
        border-color: rgba(255, 255, 255, 0.5) !important;
    }
    
    /* Stile responsive per l'input ChatGPT */
    #voice-footer #chatgpt-input {
        background: rgba(255, 255, 255, 0.95) !important;
        border: 2px solid rgba(255, 255, 255, 0.8) !important;
        color: #2c3e50 !important;
        border-radius: 25px !important;
        padding: 12px 60px 12px 16px !important;
        font-size: 14px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        transition: all 0.3s ease !important;
        width: 100% !important;
        max-width: 100% !important;
        height: 45px !important;
        box-sizing: border-box !important;
        min-width: 0 !important;
    }
    
    #voice-footer #chatgpt-input::placeholder {
        color: rgba(44, 62, 80, 0.6) !important;
        font-style: italic !important;
    }
    
    #voice-footer #chatgpt-input:focus {
        background: rgba(255, 255, 255, 1) !important;
        border-color: #3498db !important;
        outline: none !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 10px rgba(52, 152, 219, 0.3) !important;
        transform: scale(1.01) !important;
    }
    
    /* Stile uniforme per tutti i pulsanti nel footer */
    #voice-footer #send-btn:hover,
    #voice-footer #voice-chat-btn:hover,
    #voice-footer #upload-btn:hover {
        background: linear-gradient(145deg, #e8e8e8, #d0d0d0) !important;
        transform: translateY(-2px) scale(1.05) !important;
    }
    
    /* Mobile: Barra estesa con + a destra */
    @media (max-width: 480px) {
        /* CORREZIONE MOBILE: Previeni overflow */
        body {
            overflow-x: hidden !important;
        }
        
        .main-container {
            padding-left: 10px !important;
            padding-right: 10px !important;
            padding-bottom: 120px !important;
            /* padding-top gestito dinamicamente dal JavaScript */
            width: 100vw !important;
            max-width: 100vw !important;
        }
        
        .page-section {
            width: 100% !important;
            max-width: calc(100vw - 20px) !important;
            padding: 0 !important;
        }
        
        .input-page {
            padding: 20px 15px !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        
        #voice-footer {
            padding: 8px 8px !important;
        }
        
        #voice-footer > div {
            gap: 8px !important;
            padding: 0 4px !important;
            max-width: none !important;
            width: 100% !important;
        }
        
        #voice-footer #upload-btn {
            width: 38px !important;
            height: 38px !important;
            flex-shrink: 0 !important;
        }
        
        #voice-footer #chatgpt-input {
            font-size: 14px !important;
            height: 38px !important;
            padding: 10px 84px 10px 14px !important;
        }
        
        #voice-footer #send-btn,
        #voice-footer #voice-chat-btn {
            width: 30px !important;
            height: 30px !important;
            right: 4px !important;
        }
        
        #voice-footer #send-btn i,
        #voice-footer #voice-chat-btn i {
            font-size: 0.8em !important;
        }
        
        /* Chat overlay responsive */
        #ai-chat-overlay {
            bottom: 65px !important;
            width: 96% !important;
            padding: 10px 12px !important;
        }
        
        /* Dashboard cards responsive */
        .new-dashboard-grid {
            grid-template-columns: 1fr !important;
            gap: 10px !important;
            width: 100% !important;
        }
        
        .prep-list-table, .hot-items-table {
            font-size: 12px !important;
            width: 100% !important;
        }
        
        /* Tabelle inventory responsive */
        .inventory-table-container {
            overflow-x: auto !important;
            -webkit-overflow-scrolling: touch !important;
        }
        
        /* Grid pulsanti mobile: 2 colonne da 4 righe - Pulsanti ridotti del 10% */
        #step-selection-page.active .step-buttons-grid {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            grid-template-rows: repeat(4, auto) !important;
            gap: 9px !important; /* 10px - 10% = 9px */
            padding: 0 11px !important; /* 12px - 10% ‚âà 11px */
            margin-top: 23px !important; /* 18px + 5px = 23px */
            width: 100% !important;
            max-width: 100% !important;
            max-height: none !important; /* Rimuovo limitazione altezza per pulsanti grandi */
        }
        
        /* Pulsanti quadrati per mobile - ingranditi del 50% */
        #step-selection-page.active .big-step-button {
            width: 100% !important;
            height: auto !important; /* Altezza calcolata dinamicamente */
            min-height: 137px !important; /* 91px + 50% = 137px */
            max-height: none !important;
            padding: 14px 9px !important; /* 9px-6px + 50% ‚âà 14px-9px */
            font-size: 15px !important; /* 10px + 50% = 15px */
            border-radius: 14px !important; /* 9px + 50% ‚âà 14px */
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            aspect-ratio: 1 / 1 !important; /* Forza il rapporto quadrato perfetto */
        }
        
        #step-selection-page.active .big-step-button i {
            font-size: 38px !important; /* 32px + 20% = 38px */
            margin-bottom: 7px !important; /* 8px - 10% ‚âà 7px */
            margin-top: 4px !important; /* Mantiene 4px */
            color: #2E4E6F !important; /* Colore icone pi√π visibile */
        }
        
        #step-selection-page.active .big-step-button span {
            line-height: 1.1 !important;
            font-size: 15px !important; /* 11px √ó 2 = 22px (raddoppiato) */
            font-weight: 700 !important; /* Grassetto maggiore */
            text-align: center !important;
            word-break: break-word !important;
            max-height: 36px !important; /* 31px √ó 2 = 62px (raddoppiato) */
            overflow: hidden !important;
            display: block !important;
        }
    }
    
    /* Tablet: layout normale */
    @media (min-width: 481px) and (max-width: 768px) {
        /* CORREZIONE TABLET: No overflow */
        .main-container {
            padding: 20px 15px 120px 15px !important;
        }
        
        .page-section {
            max-width: calc(100vw - 30px) !important;
        }
        
        /* Dashboard tablet responsive */
        .new-dashboard-grid {
            grid-template-columns: 1fr 1fr !important;
            gap: 15px !important;
        }
        
        .new-dash-card.full-width {
            grid-column: 1 / -1 !important;
        }
        
        #voice-footer {
            padding: 8px 12px !important;
        }
        
        #voice-footer > div {
            max-width: 500px !important;
        }
        
        #voice-footer input[type="text"] {
            font-size: 14px !important;
            height: 42px !important;
        }
    }
    
    /* Schermi molto piccoli: + a destra, spazio ottimizzato */
    @media (max-width: 360px) {
        /* CORREZIONE PICCOLI SCHERMI: No overflow */
        .main-container {
            padding: 10px 5px 120px 5px !important;
        }
        
        .page-section {
            max-width: calc(100vw - 10px) !important;
        }
        
        .input-page {
            padding: 15px 10px !important;
        }
        
        /* Dashboard ultra compatta */
        .prep-list-table th, .prep-list-table td {
            padding: 4px 2px !important;
            font-size: 11px !important;
            word-break: break-word !important;
        }
        
        #voice-footer {
            padding: 6px 6px !important;
        }
        
        #voice-footer > div {
            gap: 6px !important;
            padding: 0 2px !important;
        }
        
        #voice-footer #upload-btn {
            width: 36px !important;
            height: 36px !important;
        }
        
        #voice-footer #chatgpt-input {
            font-size: 13px !important;
            height: 36px !important;
            padding: 9px 78px 9px 12px !important;
        }
        
        #voice-footer #send-btn,
        #voice-footer #voice-chat-btn {
            width: 28px !important;
            height: 28px !important;
            right: 3px !important;
        }
        
        #ai-chat-overlay {
            bottom: 60px !important;
            width: 98% !important;
            padding: 8px 10px !important;
        }
    }
</style>
</main>

<!-- Container per Chat IA - SOPRA la barra -->
<div id="ai-chat-overlay" style="
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 500px;
    background: rgba(46, 78, 111, 0.95);
    color: white;
    border-radius: 12px;
    padding: 12px 16px;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    z-index: 99;
    display: none;
    backdrop-filter: blur(10px);
">
    <div id="chatgpt-response" style="
        font-size: 14px;
        line-height: 1.4;
        max-height: 150px;
        overflow-y: auto;
        word-wrap: break-word;
        margin: 0;
    "></div>
    <button onclick="document.getElementById('ai-chat-overlay').style.display='none'" style="
        position: absolute;
        top: 8px;
        right: 12px;
        background: none;
        border: none;
        color: white;
        font-size: 18px;
        cursor: pointer;
        opacity: 0.7;
    ">√ó</button>
</div>

<footer id="voice-footer">
    <div style="display: flex; justify-content: center; align-items: center; gap: 10px; width: 100%; max-width: 700px; margin: 0 auto; padding: 0 12px; box-sizing: border-box;">
        <div style="position: relative; flex: 1; min-width: 200px;">
            <input type="text" id="chatgpt-input" placeholder="Ask me anything..." style="width: 100%; padding: 12px 90px 12px 16px; border-radius: 25px; border: 2px solid #ffffff; background: rgba(255, 255, 255, 0.95); color: #2c3e50; font-size: 14px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); transition: all 0.3s ease; outline: none; box-sizing: border-box; height: 44px;">
            <button id="send-btn" type="button" title="Send Message" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: linear-gradient(145deg, #ffffff, #e8e8e8); border: 2px solid #ffffff; color: #2c3e50; border-radius: 50%; width: 34px; height: 34px; display: none; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); transition: all 0.3s ease; cursor: pointer;">
                <i class="fas fa-paper-plane" style="font-size: 0.9em;"></i>
            </button>
            <button id="voice-chat-btn" type="button" title="Voice Message" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: linear-gradient(145deg, #ffffff, #e8e8e8); border: 2px solid #ffffff; color: #2c3e50; border-radius: 50%; width: 34px; height: 34px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); transition: all 0.3s ease; cursor: pointer;">
                <i class="fas fa-microphone" style="font-size: 0.9em;"></i>
            </button>
        </div>
        <button id="upload-btn" type="button" title="Upload File" style="background: linear-gradient(145deg, #ffffff, #e8e8e8); border: 2px solid #ffffff; color: #2c3e50; border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); transition: all 0.3s ease; cursor: pointer; flex-shrink: 0;">
            <i class="fas fa-plus" style="font-size: 1.1em;"></i>
        </button>
    </div>
</footer>
    
    <!-- PWA Installation and Service Worker -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('‚úÖ ChefCode PWA: Service Worker registered successfully');
                        
                        // Listen for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('üîÑ ChefCode: New version available! Reload to update?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.error('‚ùå ChefCode PWA: Service Worker registration failed:', error);
                    });
            });
            
            // Listen for messages from service worker
            navigator.serviceWorker.addEventListener('message', event => {
                if (event.data.type === 'SERVER_ONLINE') {
                    console.log('üåê ChefCode PWA: Server connection restored');
                    // Could show a notification or update UI
                }
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        let installButton;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üì± ChefCode PWA: Install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button/hint
            showInstallPrompt();
        });
        
        function showInstallPrompt() {
            // Create install notification
            const installBanner = document.createElement('div');
            installBanner.id = 'pwa-install-banner';
            installBanner.innerHTML = `
                <div style="
                    position: fixed; 
                    top: 90px; 
                    left: 10px; 
                    right: 10px; 
                    background: linear-gradient(145deg, #2E4E6F, #1a2f45);
                    color: white; 
                    padding: 12px 16px; 
                    border-radius: 8px; 
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    z-index: 1001;
                    animation: slideDown 0.3s ease;
                ">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <i class="fas fa-mobile-alt" style="font-size: 1.2em;"></i>
                        <div style="flex: 1;">
                            <strong>üì± Install ChefCode</strong><br>
                            <small>Add to your home screen for the best experience!</small>
                        </div>
                        <button onclick="installPWA()" style="
                            background: #4CAF50; 
                            color: white; 
                            border: none; 
                            padding: 8px 16px; 
                            border-radius: 6px; 
                            cursor: pointer;
                            font-weight: bold;
                        ">Install</button>
                        <button onclick="dismissInstall()" style="
                            background: transparent; 
                            color: #ccc; 
                            border: 1px solid #666; 
                            padding: 8px 12px; 
                            border-radius: 6px; 
                            cursor: pointer;
                        ">√ó</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(installBanner);
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (document.getElementById('pwa-install-banner')) {
                    dismissInstall();
                }
            }, 10000);
        }
        
        window.installPWA = async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`üéØ ChefCode PWA: Install outcome: ${outcome}`);
                deferredPrompt = null;
                dismissInstall();
            }
        };
        
        window.dismissInstall = () => {
            const banner = document.getElementById('pwa-install-banner');
            if (banner) {
                banner.remove();
            }
        };
        
        // Detect if running as PWA
        window.addEventListener('load', () => {
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                console.log('üéâ ChefCode PWA: Running as installed app!');
                document.body.classList.add('pwa-installed');
                
                // Add extra padding for iOS notch
                if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                    document.body.style.paddingTop = 'max(80px, env(safe-area-inset-top))';
                }
            }
        });
    </script>
    
    <style>
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* PWA specific styles */
        .pwa-installed .header {
            padding-top: max(15px, env(safe-area-inset-top));
        }
        
        @media (display-mode: standalone) {
            /* Hide browser UI hints when installed */
            body::before {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: env(safe-area-inset-top);
                background: #2E4E6F;
                z-index: 1000;
            }
        }
    </style>
    

    
    <script>
        // Calcola dinamicamente l'altezza dell'header per il padding mobile
        function updateHeaderHeight() {
            if (window.innerWidth <= 480) {
                const header = document.querySelector('.header');
                const mainContainer = document.querySelector('.main-container');
                
                if (header && mainContainer) {
                    const headerHeight = header.offsetHeight;
                    const paddingTop = headerHeight + 20 + 50 - 100; // 20px margine + 50px extra - 100px verso l'alto
                    
                    console.log(`Header height: ${headerHeight}px, Setting padding-top: ${paddingTop}px`);
                    
                    // Forza il padding-top con !important via style
                    mainContainer.style.setProperty('padding-top', `${paddingTop}px`, 'important');
                    
                    // Aggiorna anche la variabile CSS
                    document.documentElement.style.setProperty('--header-height', `${headerHeight}px`);
                }
            } else {
                // Desktop: usa il padding standard
                const mainContainer = document.querySelector('.main-container');
                if (mainContainer) {
                    mainContainer.style.removeProperty('padding-top');
                }
            }
        }
        
        // Esegui al caricamento della pagina
        document.addEventListener('DOMContentLoaded', updateHeaderHeight);
        
        // Esegui quando la finestra viene ridimensionata
        window.addEventListener('resize', updateHeaderHeight);
        
        // Esegui dopo un breve delay per assicurarsi che tutti gli stili siano caricati
        setTimeout(updateHeaderHeight, 100);
        setTimeout(updateHeaderHeight, 500); // Secondo tentativo
    </script>
    
    <script src="script.js"></script>
</body>
</html>